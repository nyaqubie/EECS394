<!DOCTYPE html> 
<html> 
	<head> 
		<title>Event Tracker</title> 
		
		<meta name="viewport" content="width=device-width, initial-scale=1"> 
		<link rel="stylesheet" href="styles/jquery.mobile-1.0rc2.min.css" />
		
		<script type="text/javascript" charset="utf-8" src="phonegap-1.1.0.js"></script>
		<script type="text/javascript" src="lib/jquery/jquery-1.6.4.min.js"></script>
		<script type="text/javascript" src="lib/jquery/jquery.mobile-1.0rc2.min.js"></script>	
		<script type="text/javascript" src="app.js"></script>
	</head> 
	
	<body>
		<div data-role="page" id="index" data-theme="b">
			<div data-role="header" id='header' data-theme="a">
				<h1 id='events'>Location</h1>
				<script type="text/javascript">
					var eveid = getQueryVariable('eventid');
					var backlink = document.createElement('a');
					backlink.setAttribute('href','event.html?eventid=' + eveid);
					backlink.setAttribute('rel','external');
					backlink.setAttribute('data-role','button');
					backlink.appendChild(document.createTextNode('Back'));
					$("#events").after(backlink);
				</script>
			</div>
			
			<a id='commitlink' OnClick='commitToLocation()' rel='external' data-role='button'>Show interest in location</a>
			
			<script type="text/javascript">
				function commitToLocation(){
					var eveid = getQueryVariable('eventid');
					var locid = getQueryVariable('locationid');
					$.ajax({
						url: 'http://69.164.198.224/showinterest',
						type: 'GET',
						dataType: 'jsonp',
						data:{uuid: 3, locationid: locid, eventid:eveid},
						jsonp: 'jsoncallback',
						timeout: 10000,
						success: function(data, status){
							$('#commitlink').remove();
							var link = document.createElement('a');
							link.setAttribute('rel','external');
							link.setAttribute('data-role','button');
							link.appendChild(document.createTextNode('You are interested in this location'));
							$("#footer").before(link);	//add the link before the footer
							$("html").trigger('create')	//needed to apply jqmobile style changes on dynamic content
						},
						error: function(){
							alert('bad')
						}
					});

				}
			</script>
			
						
			<div data-role="footer" id="footer" data-theme="a">
				<h4>Footer</h4>
			</div>
		</div>
	</body>
	
</html>